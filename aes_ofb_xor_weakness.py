from pwn import *
from binascii import unhexlify
re = remote('gc1.eng.run',30814)
context.log_level = 'DEBUG'
re.recvline()
re.recvuntil(b'\n')
c = re.recvline()
c = unhexlify(c.strip(b'\n'))
re.recv(1024)
p1 = (b'a'*16+b'b'*16)
re.sendline(str(p1.hex()))
c1 = re.recvline()
c1 = unhexlify(c1.strip(b'\n'))
re.recv(1024)
p2 = (b'c'*16+b'd'*16)
re.sendline(str(p2.hex()))
c2 = re.recvline()
c2 = unhexlify(c2.strip(b'\n'))
key1 = xor(c1,p1[16:])
key2 = xor(c2,p2[16:])
print(key1)
print(key2)
print(key1 == key2)
print(xor(key1,c))
